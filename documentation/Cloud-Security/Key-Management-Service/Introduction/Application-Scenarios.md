# 应用场景

## 以下说明京东云KMS密钥管理服务应用场景

### 小数据加解密

当小数据（例如：口令、证书、电话号码等，不大于4KB的数据）需要加解密时，用户可以通过KMS管理控制台使用在线工具加解密数据，或者调用KMS的API接口使用指定的用户主密钥直接加密、解密数据。

以保护MySQL数据库密码为例，采取调用KMS的API接口方式进行说明：

1、用户首先使用KMS服务创建一个用户主密钥；

2、调用KMS的“加密数据”接口，使用指定用户主密钥将明文MySQL数据库密码加密为密文；

3、在本地保存密文；

4、	当需要连接数据库时，调用KMS服务的“解密数据”接口，将密文密码解密为明文密码。
![小数据加解密](/image/Key-Management-Service/小数据加解密.png )

### 信封加解密数据
当有海量数据（如：照片、视频、文件等）需要加解密时，用户可采用信封加密方式加解密数据，无需通过网络将海量数据传输到KMS即可在本地完成数据加解密，在高效并且保障数据安全的同时，降低使用开销。

以保护本地存储文件为例，采取信封方式进行加解密使用说明：

- 加密

1、用户首先使用KMS服务创建一个用户主密钥；

2、用户调用KMS的“生成数据密钥”接口创建数据加密密钥DEK。用户得到一个明文的数据加密密钥和一个密文数据加密密钥；

3、用户使用明文的数据加密密钥来加密明文文件，生成密文文件，并删除明文数据密钥。

4、用户将密文的数据加密密钥和密文文件一同存储到本地存储中。
![信封加密](/image/Key-Management-Service/信封加密.png )

- 解密

1、读取密文的数据加密密钥和密文文件。

2、调用KMS的“解密数据密钥”接口，使用对应的用户主密钥解密密文的数据加密密钥，获得明文的数据加密密钥；主密钥轮换不会影响原密钥解密过程；

3、使用明文的数据加密密钥来解密密文文件，获得明文文件数据。
![信封解密](/image/Key-Management-Service/信封解密.png )

### 机密数据加密存储
在业务使用过程中，不可避免的会涉及到机密数据的使用与保存，如MySQL访问密码，如果明文存储这些机密信息，当发生黑客入侵时，容易导致机密信息泄露，造成更大的损失。

机密数据管理，是一种私密数据加密管理服务，使用服务密钥对指定私密数据进行加密存储，以标识ID代替明文数据进行访问应用程序、服务和 IT 资源所需的私密信息。借助该服务，用户可以在整个生命周期内，轮换、管理和检索数据库凭证、API 密钥和其他私密信息。用户和应用程序通过调用API来检索私密信息，从而无需对明文形式的敏感信息进行编码。

下面以业务访问MySQL数据库的场景进行介绍：
![机密场景说明1](/image/Key-Management-Service/机密场景说明图1.png )

在未使用机密加密服务的情景下，黑客一旦获取到server的权限，截取到明文的数据库连接密码，然后就可以通过工具连接数据库进行拖库。

![机密场景说明2](/image/Key-Management-Service/机密场景说明图2.png )

当使用了机密加密服务，数据库账号与密码不再以明文的形式保存，而是以标识ID的形式保存；即使黑客拿到了server权限，获取到的也是一串加密过的标识ID，无法得到明文密码，保障了机密信息的安全。

![机密场景说明3](/image/Key-Management-Service/机密场景说明图3.png )

同时，当server被黑客攻破时，可以使用机密轮换MySQL密码，并且会同步到MySQL数据库，保证机密信息的安全。

## 相关参考

- [KMS密钥管理服务介绍](/documentation/Cloud-Security/Key-Management-Service/Product-Overview.md)
